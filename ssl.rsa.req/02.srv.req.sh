#!/bin/sh

#---------------------------------------------------------------------------
. ./ssl.rsa.req.ini;
#---------------------------------------------------------------------------
echo "OUT_DIR			=	$OUT_DIR";
echo "CONF_DIR			=	$CONF_DIR";

echo "SRV_CONF_FILE		=	$SRV_CONF_FILE";

echo "SRV_PRV_FILE		=	$SRV_PRV_FILE";
echo "SRV_PUB_NSIGNED_FILE	=	$SRV_PUB_NSIGNED_FILE";
echo "SRV_CSR_FILE		=	$SRV_CSR_FILE";

echo "RSA_KEY_LENGTH		=	$RSA_KEY_LENGTH";
#---------------------------------------------------------------------------
openssl genrsa -out "$OUT_DIR"/"$SRV_PRV_FILE" "$RSA_KEY_LENGTH"
echo '---------------------------------------------------------------------'
echo 'SRV Private Key File'
echo '---------------------------------------------------------------------'
openssl rsa -noout -text -in "$OUT_DIR"/"$SRV_PRV_FILE"
echo '---------------------------------------------------------------------'
#---------------------------------------------------------------------------
openssl rsa -in "$OUT_DIR"/"$SRV_PRV_FILE" -pubout -out "$OUT_DIR"/"$SRV_PUB_NSIGNED_FILE"
#---------------------------------------------------------------------------
echo '---------------------------------------------------------------------'
echo 'SRV Non-Signed Public Key File'
echo '---------------------------------------------------------------------'
openssl rsa -text -pubin -in "$OUT_DIR"/"$SRV_PUB_NSIGNED_FILE"
echo '---------------------------------------------------------------------'
#---------------------------------------------------------------------------
openssl req -config "$CONF_DIR"/"$SRV_CONF_FILE" -new -nodes -key "$OUT_DIR"/"$SRV_PRV_FILE" -out "$OUT_DIR"/"$SRV_CSR_FILE"
#---------------------------------------------------------------------------
echo '---------------------------------------------------------------------'
echo 'SRV Certificate Request File'
echo '---------------------------------------------------------------------'
openssl req -noout -text -in "$OUT_DIR"/"$SRV_CSR_FILE"
echo '---------------------------------------------------------------------'
#---------------------------------------------------------------------------
